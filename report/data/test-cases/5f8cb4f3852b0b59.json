{"uid":"5f8cb4f3852b0b59","name":"直播间评论区进入商品复盘列表页","fullName":"testcase.test_alivia_blankMe.TestAliviaBlankMeShangPin#test_blankme_shangpin_login03","historyId":"cb73de3704dc39d9eedaf5936302a39b","time":{"start":1663980972742,"stop":1663981037206,"duration":64464},"status":"broken","statusMessage":"playwright._impl._api_types.TimeoutError: Timeout 30000.0ms exceeded while waiting for event \"popup\"\n=========================== logs ===========================\nwaiting for event \"popup\"\n============================================================","statusTrace":"self = <testcase.test_alivia_blankMe.TestAliviaBlankMeShangPin object at 0x11038e860>\nbrowser = <Browser type=<BrowserType name=chromium executable_path=/Users/edy/Library/Caches/ms-playwright/chromium-1012/chrome-mac/Chromium.app/Contents/MacOS/Chromium> version=104.0.5112.20>\nlogin_hyx = None\n\n    @allure.title(\"直播间评论区进入商品复盘列表页\")\n    @allure.severity(\"critical\")\n    def test_blankme_shangpin_login03(self, browser: Browser, login_hyx):\n        context = browser.new_context(storage_state=\"./data/blankMe_cookie_hyx.json\")\n        page = context.new_page()\n        page.goto(f\"https://blankme.{env_util.env}.meetwhale.com/vap/entry\")\n        page.wait_for_timeout(3000)\n        # 第二场直播间，第一场可能没有商品\n        page.click(':nth-match([class=\"ant-table-row ant-table-row-level-0\"], 2)')\n        page.locator(\"text=直播评论\").click()\n        page.wait_for_timeout(5000)\n        # 光标移动至滚动条所在框中\n        page.click(\".container--2haQR\")\n        for i in range(100):\n            text = page.inner_html('.container--2haQR')\n            # 滚动鼠标 , 参数给一个较大值，以保证直接移动至最后\n            page.mouse.wheel(0, 100 * i)\n            if \"title--2OCu9\" in text:\n                break\n        with page.expect_popup() as popup_info:\n>           page.locator(':nth-match(.title--2OCu9, 1)').click()\n\ntestcase/test_alivia_blankMe.py:103: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Locator frame=<Frame name= url='https://blankme.stage.meetwhale.com/vap/live-detail/1215'> selector=':nth-match(.title--2OCu9, 1)'>\n\n    def click(\n        self,\n        *,\n        modifiers: typing.Optional[\n            typing.List[Literal[\"Alt\", \"Control\", \"Meta\", \"Shift\"]]\n        ] = None,\n        position: Position = None,\n        delay: float = None,\n        button: Literal[\"left\", \"middle\", \"right\"] = None,\n        click_count: int = None,\n        timeout: float = None,\n        force: bool = None,\n        no_wait_after: bool = None,\n        trial: bool = None\n    ) -> NoneType:\n        \"\"\"Locator.click\n    \n        This method clicks the element by performing the following steps:\n        1. Wait for [actionability](https://playwright.dev/python/docs/actionability) checks on the element, unless `force` option is set.\n        1. Scroll the element into view if needed.\n        1. Use `page.mouse` to click in the center of the element, or the specified `position`.\n        1. Wait for initiated navigations to either succeed or fail, unless `noWaitAfter` option is set.\n    \n        If the element is detached from the DOM at any moment during the action, this method throws.\n    \n        When all steps combined have not finished during the specified `timeout`, this method throws a `TimeoutError`. Passing\n        zero timeout disables this.\n    \n        Parameters\n        ----------\n        modifiers : Union[List[Union[\"Alt\", \"Control\", \"Meta\", \"Shift\"]], NoneType]\n            Modifier keys to press. Ensures that only these modifiers are pressed during the operation, and then restores current\n            modifiers back. If not specified, currently pressed modifiers are used.\n        position : Union[{x: float, y: float}, NoneType]\n            A point to use relative to the top-left corner of element padding box. If not specified, uses some visible point of the\n            element.\n        delay : Union[float, NoneType]\n            Time to wait between `mousedown` and `mouseup` in milliseconds. Defaults to 0.\n        button : Union[\"left\", \"middle\", \"right\", NoneType]\n            Defaults to `left`.\n        click_count : Union[int, NoneType]\n            defaults to 1. See [UIEvent.detail].\n        timeout : Union[float, NoneType]\n            Maximum time in milliseconds, defaults to 30 seconds, pass `0` to disable timeout. The default value can be changed by\n            using the `browser_context.set_default_timeout()` or `page.set_default_timeout()` methods.\n        force : Union[bool, NoneType]\n            Whether to bypass the [actionability](../actionability.md) checks. Defaults to `false`.\n        no_wait_after : Union[bool, NoneType]\n            Actions that initiate navigations are waiting for these navigations to happen and for pages to start loading. You can\n            opt out of waiting via setting this flag. You would only need this option in the exceptional cases such as navigating to\n            inaccessible pages. Defaults to `false`.\n        trial : Union[bool, NoneType]\n            When set, this method only performs the [actionability](../actionability.md) checks and skips the action. Defaults to\n            `false`. Useful to wait until the element is ready for the action without performing it.\n        \"\"\"\n    \n        return mapping.from_maybe_impl(\n>           self._sync(\n                self._impl_obj.click(\n                    modifiers=mapping.to_impl(modifiers),\n                    position=position,\n                    delay=delay,\n                    button=button,\n                    clickCount=click_count,\n                    timeout=timeout,\n                    force=force,\n                    noWaitAfter=no_wait_after,\n                    trial=trial,\n                )\n            )\n        )\n\n../whale01/venv/lib/python3.10/site-packages/playwright/sync_api/_generated.py:12230: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Locator frame=<Frame name= url='https://blankme.stage.meetwhale.com/vap/live-detail/1215'> selector=':nth-match(.title--2OCu9, 1)'>\ncoro = <coroutine object Locator.click at 0x11174fed0>\n\n    def _sync(self, coro: Awaitable) -> Any:\n        __tracebackhide__ = True\n        g_self = greenlet.getcurrent()\n        task = self._loop.create_task(coro)\n        setattr(task, \"__pw_stack__\", inspect.stack())\n        setattr(task, \"__pw_stack_trace__\", traceback.extract_stack())\n    \n        task.add_done_callback(lambda _: g_self.switch())\n        while not task.done():\n            self._dispatcher_fiber.switch()\n        asyncio._set_running_loop(self._loop)\n>       return task.result()\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_sync_base.py:89: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Locator frame=<Frame name= url='https://blankme.stage.meetwhale.com/vap/live-detail/1215'> selector=':nth-match(.title--2OCu9, 1)'>\nmodifiers = None, position = None, delay = None, button = None\nclickCount = None, timeout = None, force = None, noWaitAfter = None\ntrial = None\n\n    async def click(\n        self,\n        modifiers: List[KeyboardModifier] = None,\n        position: Position = None,\n        delay: float = None,\n        button: MouseButton = None,\n        clickCount: int = None,\n        timeout: float = None,\n        force: bool = None,\n        noWaitAfter: bool = None,\n        trial: bool = None,\n    ) -> None:\n        params = locals_to_params(locals())\n>       return await self._frame.click(self._selector, strict=True, **params)\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_locator.py:144: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Frame name= url='https://blankme.stage.meetwhale.com/vap/live-detail/1215'>\nselector = ':nth-match(.title--2OCu9, 1)', modifiers = None, position = None\ndelay = None, button = None, clickCount = None, timeout = None, force = None\nnoWaitAfter = None, strict = True, trial = None\n\n    async def click(\n        self,\n        selector: str,\n        modifiers: List[KeyboardModifier] = None,\n        position: Position = None,\n        delay: float = None,\n        button: MouseButton = None,\n        clickCount: int = None,\n        timeout: float = None,\n        force: bool = None,\n        noWaitAfter: bool = None,\n        strict: bool = None,\n        trial: bool = None,\n    ) -> None:\n>       await self._channel.send(\"click\", locals_to_params(locals()))\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_frame.py:474: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x11163a140>\nmethod = 'click'\nparams = {'selector': ':nth-match(.title--2OCu9, 1)', 'strict': True}\n\n    async def send(self, method: str, params: Dict = None) -> Any:\n>       return await self._connection.wrap_api_call(\n            lambda: self.inner_send(method, params, False)\n        )\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_connection.py:43: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    async def _() -> None:\n        try:\n>           return await result\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_connection.py:370: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x11163a140>\nmethod = 'click'\nparams = {'selector': ':nth-match(.title--2OCu9, 1)', 'strict': True}\nreturn_as_dict = False\n\n    async def inner_send(\n        self, method: str, params: Optional[Dict], return_as_dict: bool\n    ) -> Any:\n        if params is None:\n            params = {}\n        callback = self._connection._send_message_to_server(self._guid, method, params)\n        if self._connection._error:\n            error = self._connection._error\n            self._connection._error = None\n            raise error\n        done, _ = await asyncio.wait(\n            {\n                self._connection._transport.on_error_future,\n                callback.future,\n            },\n            return_when=asyncio.FIRST_COMPLETED,\n        )\n        if not callback.future.done():\n            callback.future.cancel()\n>       result = next(iter(done)).result()\nE       playwright._impl._api_types.TimeoutError: Timeout 30000ms exceeded.\nE       =========================== logs ===========================\nE       waiting for selector \":nth-match(.title--2OCu9, 1)\"\nE         selector resolved to visible <span class=\"title--2OCu9\">blankme半分一 黑盒气垫5件套46.2g（气垫正装替换装隔离试卡）</span>\nE       attempting click action\nE         waiting for element to be visible, enabled and stable\nE       element was detached from the DOM, retrying\nE       waiting for selector \":nth-match(.title--2OCu9, 1)\"\nE         selector resolved to visible <span class=\"title--2OCu9\">blankme半分一 黑盒气垫5件套46.2g（气垫正装替换装隔离试卡）</span>\nE       attempting click action\nE         waiting for element to be visible, enabled and stable\nE       element was detached from the DOM, retrying\nE       waiting for selector \":nth-match(.title--2OCu9, 1)\"\nE         selector resolved to visible <span class=\"title--2OCu9\">blankme半分一 黑盒气垫5件套46.2g（气垫正装替换装隔离试卡）</span>\nE       attempting click action\nE         waiting for element to be visible, enabled and stable\nE       element was detached from the DOM, retrying\nE       waiting for selector \":nth-match(.title--2OCu9, 1)\"\nE         selector resolved to visible <span class=\"title--2OCu9\">blankme半分一油皮气垫5件套43.7g(银盒替换粉扑隔离试色卡）</span>\nE       attempting click action\nE         waiting for element to be visible, enabled and stable\nE       element was detached from the DOM, retrying\nE       waiting for selector \":nth-match(.title--2OCu9, 1)\"\nE       ============================================================\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_connection.py:78: TimeoutError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <testcase.test_alivia_blankMe.TestAliviaBlankMeShangPin object at 0x11038e860>\nbrowser = <Browser type=<BrowserType name=chromium executable_path=/Users/edy/Library/Caches/ms-playwright/chromium-1012/chrome-mac/Chromium.app/Contents/MacOS/Chromium> version=104.0.5112.20>\nlogin_hyx = None\n\n    @allure.title(\"直播间评论区进入商品复盘列表页\")\n    @allure.severity(\"critical\")\n    def test_blankme_shangpin_login03(self, browser: Browser, login_hyx):\n        context = browser.new_context(storage_state=\"./data/blankMe_cookie_hyx.json\")\n        page = context.new_page()\n        page.goto(f\"https://blankme.{env_util.env}.meetwhale.com/vap/entry\")\n        page.wait_for_timeout(3000)\n        # 第二场直播间，第一场可能没有商品\n        page.click(':nth-match([class=\"ant-table-row ant-table-row-level-0\"], 2)')\n        page.locator(\"text=直播评论\").click()\n        page.wait_for_timeout(5000)\n        # 光标移动至滚动条所在框中\n        page.click(\".container--2haQR\")\n        for i in range(100):\n            text = page.inner_html('.container--2haQR')\n            # 滚动鼠标 , 参数给一个较大值，以保证直接移动至最后\n            page.mouse.wheel(0, 100 * i)\n            if \"title--2OCu9\" in text:\n                break\n>       with page.expect_popup() as popup_info:\n\ntestcase/test_alivia_blankMe.py:102: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_sync_base.py:66: in __exit__\n    self._event.value\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._sync_base.EventInfo object at 0x1120b07c0>\n\n    @property\n    def value(self) -> T:\n        while not self._future.done():\n            self._sync_base._dispatcher_fiber.switch()\n        asyncio._set_running_loop(self._sync_base._loop)\n        exception = self._future.exception()\n        if exception:\n>           raise exception\nE           playwright._impl._api_types.TimeoutError: Timeout 30000.0ms exceeded while waiting for event \"popup\"\nE           =========================== logs ===========================\nE           waiting for event \"popup\"\nE           ============================================================\n\n../whale01/venv/lib/python3.10/site-packages/playwright/_impl/_sync_base.py:46: TimeoutError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"delete_output_dir","time":{"start":1663980949422,"stop":1663980949422,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"base_url","time":{"start":1663980949422,"stop":1663980949422,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"playwright","time":{"start":1663980949422,"stop":1663980950131,"duration":709},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"pytestconfig","time":{"start":1663980949422,"stop":1663980949422,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"_verify_url","time":{"start":1663980949422,"stop":1663980949422,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"browser_type_launch_args","time":{"start":1663980949422,"stop":1663980949422,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"launch_browser","time":{"start":1663980950132,"stop":1663980950132,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"browser_type","time":{"start":1663980950132,"stop":1663980950132,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"browser","time":{"start":1663980950132,"stop":1663980950595,"duration":463},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"login_hyx","time":{"start":1663980950596,"stop":1663980972741,"duration":22145},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false}],"afterStages":[{"name":"login_hyx::0","time":{"start":1663981147159,"stop":1663981147159,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"browser::0","time":{"start":1663981147159,"stop":1663981147345,"duration":186},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"playwright::0","time":{"start":1663981147346,"stop":1663981147361,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false}],"labels":[{"name":"feature","value":"商品复盘模块"},{"name":"severity","value":"critical"},{"name":"parentSuite","value":"testcase"},{"name":"suite","value":"test_alivia_blankMe"},{"name":"subSuite","value":"TestAliviaBlankMeShangPin"},{"name":"host","value":"edydeMacBook-Pro-10.local"},{"name":"thread","value":"1003-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testcase.test_alivia_blankMe"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"5f8cb4f3852b0b59.json","parameterValues":["'chromium'"]}